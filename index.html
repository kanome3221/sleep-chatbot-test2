<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ìˆ˜ë©´ ë¶„ì„ ì±—ë´‡</title>
  <style>
    body { font-family: sans-serif; margin: 2rem; }
    textarea { width: 100%; height: 100px; }
    #result { margin-top: 1rem; padding: 1rem; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <h1>ìˆ˜ë©´ ë¶„ì„ ì±—ë´‡</h1>
  <textarea id="message" placeholder="ìµœê·¼ ìˆ˜ë©´ ìŠµê´€ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”..."></textarea>
  <button onclick="sendMessage()">ë¶„ì„ ìš”ì²­</button>
  <div id="result">ë¶„ì„ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>

  <script>
    async function sendMessage() {
      const message = document.getElementById("message").value;
      const resultElement = document.getElementById("result");
      resultElement.textContent = "ë¶„ì„ ì¤‘...";

      try {
        const response = await fetch("/api/gpt", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message })
        });

        const data = await response.json();

        if (data.result) {
          const { summary, issues, suggestions } = data.result;
          resultElement.innerHTML = `
            <strong>ğŸ“ ìš”ì•½:</strong> ${summary}<br>
            <strong>âš ï¸ ë¬¸ì œì :</strong> <ul>${issues.map(i => `<li>${i}</li>`).join("")}</ul>
            <strong>ğŸ’¡ ì†”ë£¨ì…˜:</strong> <ul>${suggestions.map(s => `<li>${s}</li>`).join("")}</ul>
          `;
        } else if (data.reply) {
          resultElement.innerHTML = `
            <strong>GPT ì‘ë‹µ (ì›ë¬¸):</strong><br>${data.reply}<br><br>
            âš ï¸ GPTê°€ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
          `;
        } else {
          throw new Error("ë¶„ì„ ê²°ê³¼ ì—†ìŒ");
        }
      } catch (error) {
        console.error("ë¶„ì„ ì‹¤íŒ¨:", error);
        resultElement.textContent = "ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";
      }
    }
  </script>
</body>
</html>
